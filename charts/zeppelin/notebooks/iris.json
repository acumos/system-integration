{"paragraphs":[{"text":"%sh\n# Prerequisites\n# Set Interpreter / Python / zeppelin.python = python3\n# Set Interpreter / sh / shell.command.timeout.millisecs = 600000\n\napt-get --no-install-recommends install -y python3-pip\npip3 install acumos\npip3 install sklearn\npip3 install pandas\npip3 install protobuf\n\nPROTOC_ZIP=protoc-3.3.0-linux-x86_64.zip\ncurl -OL https://github.com/google/protobuf/releases/download/v3.3.0/$PROTOC_ZIP\nunzip -o $PROTOC_ZIP -d /usr/local bin/protoc\nrm -f $PROTOC_ZIP\n\nwhich protoc\nls\ncd $HOME\npwd\nwget -O acumos-push.py https://wiki.acumos.org/download/attachments/17694974/acumos-push.py","user":"anonymous","dateUpdated":"2019-02-16T16:23:25+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550333960049_1038633763","id":"20190216-150012_1273160443","dateCreated":"2019-02-16T16:19:20+0000","dateStarted":"2019-02-16T16:19:37+0000","dateFinished":"2019-02-16T16:20:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4023"},{"text":"%python\n# \nimport os\nimport os.path\n\nos.chdir('/root')\n\nimport time\n\nfrom acumos.session import AcumosSession\nfrom acumos.modeling import Model, List, create_dataframe\n \nimport numpy as np\nimport pandas as pd\nfrom sklearn.datasets import load_iris\nfrom sklearn.ensemble import RandomForestClassifier\n\niris = load_iris()\nX = iris.data\ny = iris.target\n \nclf = RandomForestClassifier(random_state=0)\nclf.fit(X, y)\n\n# here, an appropriate NamedTuple type is inferred from a pandas DataFrame\nX_df = pd.DataFrame(X, columns=['sepal_length', 'sepal_width', 'petal_length', 'petal_width'])\nIrisDataFrame = create_dataframe('IrisDataFrame', X_df)\n \n# ==================================================================================\n# # or equivalently:\n#\n# IrisDataFrame = create_namedtuple('IrisDataFrame', [('sepal_length', List[float]),\n#                                                     ('sepal_width', List[float]),\n#                                                     ('petal_length', List[float]),\n#                                                     ('petal_width', List[float])])\n# ==================================================================================\n \ndef classify_iris(df: IrisDataFrame) -> List[int]:\n    '''Returns an array of iris classifications'''\n    X = np.column_stack(df)\n    return clf.predict(X)\n \nmodel = Model(classify=classify_iris)\n \nsession = AcumosSession()\n\nif os.path.exists(\"iris_sklearn\"):\n    os.remove('iris_sklearn/metadata.json')\n    os.remove('iris_sklearn/model.proto')\n    os.remove('iris_sklearn/model.zip')\n    os.rmdir('iris_sklearn')\n\nsession.dump(model,'iris_sklearn','~/.')\n\nwhile not os.path.exists(\"iris_sklearn\"):\n    time.sleep(1)\n\nprint(\"The trained model has been dumped into the iris_sklearn folder\")\nfiles = os.listdir('iris_sklearn')\nfor name in files:\n    print(name)\n","user":"anonymous","dateUpdated":"2019-02-16T16:23:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550333960055_2031872107","id":"20190216-150357_1735847825","dateCreated":"2019-02-16T16:19:20+0000","dateStarted":"2019-02-16T16:23:31+0000","dateFinished":"2019-02-16T16:23:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4024"},{"text":"%sh\ncd $HOME\nls\nexport ACUMOS_ONBOARDING_PORT=8090\nexport ACUMOS_ONBOARDING_TOKENMODE=jwtToken\nexport ACUMOS_ONBOARDING_CLIAUTHURL=\"http://onboarding-service:$ACUMOS_ONBOARDING_PORT/onboarding-app/v2/auth\"\nexport ACUMOS_ONBOARDING_CLIPUSHURL=\"http://onboarding-service:$ACUMOS_ONBOARDING_PORT/onboarding-app/v2/models\"\nexport ACUMOS_USERNAME=test\nexport ACUMOS_PASSWORD='P@ssw0rd'\nexport ACUMOS_TOKEN=''\nexport ACUMOS_DUMPDIR='iris_sklearn'\npython3 acumos-push.py","user":"anonymous","dateUpdated":"2019-02-16T16:23:42+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550333960056_1896020526","id":"20190216-150439_84457041","dateCreated":"2019-02-16T16:19:20+0000","dateStarted":"2019-02-16T16:23:42+0000","dateFinished":"2019-02-16T16:29:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4025"},{"text":"","user":"anonymous","dateUpdated":"2019-02-16T16:19:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550333960056_-2056019574","id":"20190216-150759_1859191291","dateCreated":"2019-02-16T16:19:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4026"}],"name":"iris","id":"2E315VKDP","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
